interface Message {
  text: string;
  sender: 'user' | 'ai';
}

const mockResponses: Record<string, string> = {
  "default": "我是您的健康助手，很高兴为您提供帮助。我可以回答关于健身、营养和健康生活方式的问题。",
  
  "什么运动适合初学者？": 
    "以下是适合初学者的运动项目：\n\n" +
    "# 初学者友好的运动项目\n\n" +
    "## 有氧运动\n" +
    "- 步行：最简单易行的有氧运动，每天30分钟\n" +
    "- 慢跑：比步行强度更高，开始时可以步行和慢跑交替进行\n" +
    "- 游泳：全身性运动，对关节压力小\n" +
    "- 骑自行车：户外或室内健身车都可以\n\n" +
    "## 力量训练\n" +
    "- 徒手深蹲：锻炼下半身大肌群\n" +
    "- 膝盖俯卧撑：适合上肢力量较弱的初学者\n" +
    "- 平板支撑：核心力量训练的基础动作\n" +
    "- 哑铃卷举：开始可以选择轻重量\n\n" +
    "✅ 记住，保持正确姿势比增加强度更重要\n" +
    "✅ 每周坚持3-4次，每次30-45分钟\n" +
    "✅ 运动前热身，运动后拉伸很重要",

  "如何开始一个锻炼计划？": 
    "# 开始健身计划的步骤\n\n" +
    "1. **设定明确目标**：减重、增肌、提高体能或改善健康\n" +
    "2. **评估当前体能水平**：了解自己的起点\n" +
    "3. **制定循序渐进的计划**：\n" +
    "   - 第1周：每周3天，每次20-30分钟\n" +
    "   - 第2-3周：每周3-4天，每次30-40分钟\n" +
    "   - 第4周后：每周4-5天，每次40-60分钟\n\n" +
    "4. **平衡训练内容**：\n" +
    "   - 有氧训练：2-3次/周\n" +
    "   - 力量训练：2-3次/周\n" +
    "   - 灵活性训练：每次锻炼后\n\n" +
    "5. **记录进度**：使用健身应用或日记记录每次锻炼\n" +
    "6. **保持一致性**：坚持是成功的关键\n\n" +
    "✅ 开始时强度较低，逐渐增加\n" +
    "✅ 聆听身体信号，避免过度训练\n" +
    "✅ 如有特殊健康状况，建议咨询医生",

  "如何创建个性化的锻炼计划？": 
    "# 创建个性化锻炼计划指南\n\n" +
    "## 评估阶段\n" +
    "1. **健康状况评估**：了解自身健康限制\n" +
    "2. **体能水平测试**：测试力量、耐力、灵活性\n" +
    "3. **明确目标定义**：减脂、增肌、提高心肺功能\n\n" +
    "## 设计阶段\n" +
    "1. **频率**：根据时间和恢复能力决定每周训练3-5天\n" +
    "2. **时长**：每次30-90分钟\n" +
    "3. **类型**：结合以下训练类型\n" +
    "   - 力量训练：重量和重复次数根据目标调整\n" +
    "   - 有氧训练：强度和时间根据体能决定\n" +
    "   - 灵活性训练：动态和静态拉伸\n" +
    "   - 核心训练：保持良好姿势的基础\n\n" +
    "## 执行与调整\n" +
    "- **进阶原则**：每2-3周增加训练负荷\n" +
    "- **休息与恢复**：肌肉群至少休息48小时\n" +
    "- **监测与调整**：记录进度，根据反馈调整\n\n" +
    "✅ 计划应当有趣且可持续\n" +
    "✅ 考虑设备和场地的可用性\n" +
    "✅ 定期更新计划以避免适应性停滞",

  "每周应该锻炼多少次？": 
    "# 每周锻炼频率指南\n\n" +
    "最佳锻炼频率取决于多种因素，包括您的目标、健康状况、恢复能力和时间安排。以下是一般建议：\n\n" +
    "## 一般健康维护\n" +
    "- **有氧活动**：中等强度有氧运动每周至少150分钟，或高强度有氧运动每周75分钟\n" +
    "- **力量训练**：每周2-3次，主要肌群训练\n\n" +
    "## 减脂目标\n" +
    "- **有氧训练**：每周4-5次，每次30-60分钟\n" +
    "- **力量训练**：每周2-3次，全身性训练\n" +
    "- **HIIT训练**：每周1-2次，提高代谢率\n\n" +
    "## 增肌目标\n" +
    "- **力量训练**：每周3-5次，分化训练不同肌群\n" +
    "- **有氧训练**：每周2-3次，控制在20-30分钟\n\n" +
    "## 特殊考虑因素\n" +
    "- **初学者**：从每周3次开始，每次30-45分钟\n" +
    "- **高级健身者**：可能每周训练5-6次，但确保充分恢复\n" +
    "- **年长者**：每周3-4次，强调平衡性和灵活性训练\n\n" +
    "✅ 确保每周至少有1-2天完全休息\n" +
    "✅ 聆听身体信号，过度训练会适得其反\n" +
    "✅ 逐渐增加训练频率和强度",

  "锻炼后如何恢复？": 
    "# 有效的锻炼后恢复策略\n\n" +
    "## 立即恢复（锻炼后0-30分钟）\n" +
    "1. **冷却放松**：5-10分钟低强度活动\n" +
    "2. **拉伸**：对主要使用的肌群进行静态拉伸，每个动作持续15-30秒\n" +
    "3. **水合作用**：补充流失的水分\n" +
    "4. **营养补充**：摄入蛋白质和碳水化合物的组合\n\n" +
    "## 短期恢复（24小时内）\n" +
    "1. **均衡饮食**：补充足够的蛋白质、碳水化合物和健康脂肪\n" +
    "2. **充分水合**：全天持续补充水分\n" +
    "3. **足够睡眠**：7-9小时的优质睡眠\n" +
    "4. **轻度活动**：如散步或轻度伸展，促进血液循环\n\n" +
    "## 长期恢复策略\n" +
    "1. **主动恢复日**：在高强度训练日之间安排低强度活动\n" +
    "2. **按摩或泡沫轴滚动**：缓解肌肉紧张\n" +
    "3. **冷热疗法**：冰浴或热浴，或两者交替\n" +
    "4. **定期休息日**：每周安排1-2天完全休息\n\n" +
    "## 恢复信号监测\n" +
    "- **疲劳程度**：持续性疲劳表明需要更多恢复\n" +
    "- **肌肉酸痛**：过度酸痛需要延长恢复期\n" +
    "- **性能下降**：训练表现下降表明恢复不足\n\n" +
    "✅ 恢复与训练同等重要\n" +
    "✅ 个体化恢复策略，适应自身需求\n" +
    "✅ 循序渐进增加训练强度，给身体适应时间",

  "什么饮食最适合配合运动？": 
    "# 运动配合饮食指南\n\n" +
    "## 基本营养原则\n" +
    "- **蛋白质**：0.8-2.0克/千克体重/天\n" +
    "- **碳水化合物**：3-10克/千克体重/天(根据训练强度调整)\n" +
    "- **脂肪**：总热量的20-35%\n" +
    "- **水分**：每天至少2-3升\n\n" +
    "## 训练前饮食（1-3小时前）\n" +
    "- **目标**：提供能量，避免饥饿感，不造成消化不适\n" +
    "- **推荐**：\n" +
    "  - 全麦吐司配香蕉和少量花生酱\n" +
    "  - 燕麦配水果和蜂蜜\n" +
    "  - 酸奶配少量谷物和浆果\n\n" +
    "## 训练中补充\n" +
    "- **适用于**：持续超过60-90分钟的训练\n" +
    "- **推荐**：\n" +
    "  - 运动饮料（含电解质和碳水）\n" +
    "  - 易消化的能量胶或能量棒\n\n" +
    "## 训练后饮食（30-60分钟内）\n" +
    "- **目标**：促进恢复，补充肌糖原，支持肌肉修复\n" +
    "- **推荐**：\n" +
    "  - 蛋白质奶昔配香蕉\n" +
    "  - 鸡胸肉配糙米和蔬菜\n" +
    "  - 金枪鱼三明治配全麦面包\n\n" +
    "## 不同训练目标的饮食调整\n" +
    "- **增肌**：略微热量盈余(+200-500卡/天)，高蛋白\n" +
    "- **减脂**：适度热量赤字(-300-500卡/天)，保持蛋白质摄入\n" +
    "- **耐力训练**：增加碳水摄入，特别是训练前后\n\n" +
    "✅ 个性化饮食计划比通用建议更有效\n" +
    "✅ 食物质量与数量同样重要\n" +
    "✅ 饮食应支持训练目标但也要可持续和令人愉悦"
};

export const sendMessage = async (messages: Message[]): Promise<string> => {
  await new Promise(resolve => setTimeout(resolve, 1000));
  
  const lastUserMessage = messages.filter(msg => msg.sender === 'user').pop();
  
  if (!lastUserMessage) {
    return mockResponses["default"];
  }
  
  const userQuery = lastUserMessage.text.trim();
  
  return mockResponses[userQuery] || 
    `您问的是关于"${userQuery}"的问题。\n\n我是测试模式下的健康助手，可以回答关于健身、营养和健康生活方式的问题。这是一个模拟回复，用于测试界面功能。\n\n您可以尝试问以下问题：\n\n- 什么运动适合初学者？\n- 如何开始一个锻炼计划？\n- 如何创建个性化的锻炼计划？\n- 每周应该锻炼多少次？\n- 锻炼后如何恢复？\n- 什么饮食最适合配合运动？`;
};